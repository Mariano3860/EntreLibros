@import '@styles/variables';

/* ====== Wrapper & Header ====== */
.wrapper {
  display: flex;
  flex-direction: column;
  margin: $spacing-1 0 $spacing-1;
}

.header {
  display: flex;
  align-items: baseline;
  gap: $spacing-2;
}

.title {
  font-size: $h5-font-size;
  font-weight: $font-weight-medium;
  margin: 0;
}

.mapLink {
  margin-left: auto;
  background: none;
  border: none;
  color: var(--primary-color);
  font-size: $small-font-size;
  font-weight: $font-weight-medium;
  cursor: pointer;
  padding: $spacing-1;
  transition: color $transition-duration-fast $transition-timing-function;

  &:hover,
  &:focus-visible {
    color: var(--primary-dark);
    outline: none;
  }
}

/* ====== Horizontal list ====== */
.cards {
  display: flex;
  gap: $spacing-1x5;
  overflow-x: auto;
  padding: $spacing-1 0;
  scroll-snap-type: x proximity;
  scroll-padding-left: $spacing-1;
  scrollbar-width: none;
  -ms-overflow-style: none;

  &::-webkit-scrollbar {
    display: none;
  }
}

/* ====== Card ====== */
.card {
  flex: 0 0 auto;
  width: rem(150px);
  background: var(--background-card);
  border: 1px solid var(--border-color);
  border-radius: rem(16px);
  padding: $spacing-2x5 $spacing-2;
  box-shadow: $box-shadow-sm;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: $spacing-1x5;
  scroll-snap-align: start;
  transition:
    box-shadow $transition-duration-fast $transition-timing-function,
    transform $transition-duration-fast $transition-timing-function;

  &:hover,
  &:focus-within {
    box-shadow: $box-shadow-md;
    transform: translateY(rem(-2px));
  }
}

/* ====== Figure & Avatar ====== */
.figure {
  /* We don't need flex here; the avatar is centered by its own wrapper */
  margin: 0;
  width: 100%;
  display: block;
}

/* New wrapper: anchors the badge to the avatar box (1:1) */
.avatarWrap {
  position: relative;
  width: rem(100px);
  height: rem(100px);
  margin: 0 auto;
  display: grid;
  place-items: center; /* perfectly center the avatar inside */
}

.avatar {
  width: 100%;
  height: 100%;
  border-radius: 50%;
  object-fit: cover;
  border: 1px solid rgb(0 0 0 / 8%);
  box-shadow: 0 1px 2px rgb(0 0 0 / 8%);
  background: var(--color-neutral-200);
}

/* ====== Meta ====== */
.meta {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: $spacing-1;
  text-align: center;
}

.name {
  font-size: $body-font-size;
  font-weight: $font-weight-medium;
  margin: 0;
  color: var(--text-primary);
  line-height: 1.2;

  /* keep card heights consistent with long names */
  display: -webkit-box;
  -webkit-line-clamp: 2;
  -webkit-box-orient: vertical;
  overflow: hidden;
  text-overflow: ellipsis;
}

.distance {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: $spacing-1;
  font-size: $small-font-size;
  color: var(--text-secondary);
  background: rgb(var(--primary-rgb), 0.08);
  border-radius: rem(999px);
  padding: $spacing-1x5 $spacing-2;
}

/* ====== Activity badge (overlay) ====== */
.activity {
  position: absolute;
  right: rem(-6px);
  bottom: rem(-4px);
  z-index: 2;
  min-width: rem(22px);
  height: rem(22px);
  padding: 0 $spacing-1;
  border-radius: rem(999px);
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: rem(4px); /* space for the icon */
  font-size: rem(13px);
  line-height: 1;
  font-weight: $font-weight-medium;
  color: var(--primary-light);
  background: rgba(var(--primary-super-dark), 0.5);
  background: color-mix(in srgb, var(--primary-super-dark) 50%, transparent);
  box-shadow: 0 2px 8px rgb(var(--shadow-md) / 25%);
  backdrop-filter: blur(5px);
  pointer-events: auto; /* needed to receive focus/hover for tooltip */
  white-space: nowrap;
  outline: none;
}

/* Small semantic icon: left-right arrows */
.activity::before {
  content: 'â‡„'; /* swap/exchange icon */
  font-size: rem(12px);
  opacity: 0.9;
}

/* Tooltip (desktop/keyboard): uses data-title text */
.activity[data-title]::after {
  content: attr(data-title);
  position: absolute;
  bottom: 100%;
  right: 0;
  transform: translateY(rem(-6px));
  padding: rem(6px) rem(8px);
  font-size: rem(12px);
  color: #fff;
  background: rgb(0 0 0 / 80%);
  border-radius: rem(8px);
  white-space: nowrap;
  pointer-events: none;
  opacity: 0;
  transition:
    opacity $transition-duration-fast $transition-timing-function,
    transform $transition-duration-fast $transition-timing-function;
}

/* Show tooltip on hover/focus (desktop + keyboard) */
@media (hover: hover) {
  .activity:hover::after,
  .activity:focus-visible::after {
    opacity: 1;
    transform: translateY(rem(-8px));
  }
}

/* If empty, don't render any box at all */
.activity:empty {
  display: none;
}

/* ====== Status & Skeleton ====== */
.status {
  margin: 0;
  color: var(--text-secondary);
  font-size: $small-font-size;
}

.skeleton {
  position: relative;
  overflow: hidden;
  min-height: rem(132px);

  &::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(
      90deg,
      rgb(255 255 255 / 0%) 0%,
      rgb(255 255 255 / 50%) 50%,
      rgb(255 255 255 / 0%) 100%
    );
    animation: shimmer 1.4s infinite;
  }
}

@keyframes shimmer {
  0% {
    transform: translateX(-100%);
  }
  100% {
    transform: translateX(100%);
  }
}

/* ====== Breakpoints ====== */
@media (max-width: $breakpoint-tablet) {
  .wrapper {
    margin: $spacing-2x5 0 $spacing-3;
  }

  .title {
    font-size: $h6-font-size;
  }

  .card {
    width: rem(140px);
    padding: $spacing-2 $spacing-1x5;
    gap: $spacing-1x5;
  }

  .avatarWrap {
    width: rem(52px);
    height: rem(52px);
  }

  .avatar {
    width: 100%;
    height: 100%;
  }
}

@media (max-width: $breakpoint-mobile) {
  .card {
    width: rem(128px);
  }

  .avatarWrap {
    width: rem(48px);
    height: rem(48px);
  }

  .avatar {
    width: 100%;
    height: 100%;
  }
}
